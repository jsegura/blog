<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="What are websockets?">
    <meta name="author" content="Javier Segura">
    <meta name="generator" content="Hugo" /> 
    <meta name="description" content="Personal blog of Javier Segura. Sysadmin, devops and related stuff.">
    <meta name="keywords" content="devops, sysadmin, system administrator, golang, blog">

    <title>Websockets - http://javiersegura.net/</title>
    <link rel="canonical" href="http://javiersegura.net/post/websockets">
    
    <link href="http://javiersegura.net/css/bootstrap.css" rel="stylesheet">
    <link href="http://javiersegura.net/css/font-awesome.css" rel="stylesheet">
    <link href="http://javiersegura.net/css/custom.css" rel="stylesheet">
    

 <link rel="stylesheet" href="https://yandex.st/highlightjs/8.0/styles/default.min.css">
 <script src="https://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://javiersegura.net/">my blog</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://javiersegura.net/post/">Posts</a></li>
                    
                </ul>
            </div>
        </div>
    </nav>
<div class="container">
    <div class="row">
        <div class="col-md-9">
            <div class="well well-sm">
                    <h3>Websockets<br> <small>What are websockets?</small></h3>
                    <hr>
                    <p>A <strong>Websocket</strong> is a protocol that provides dual-channel communication between web servers and web browsers. It uses the <em>HTTP</em> protocol as a handshake but it has its own <em>TCP-based</em> protocol.
This is useful for enabling a better interaction between your web users, it&rsquo;s a real-timeand once the request is started by the client, the server can send information over the websocket without the requisition from the client.</p>

<p>A demo site <a href="http://www.websocket.org/echo.html">Echo test</a> is available using <code>ws://echo.websocket.org</code>.</p>

<p>We can see how the communication is started looking at the network traffic using your preferred tool (in my case <em>Developer tools</em> from Chrome is more than enough).</p>

<p><br /></p>

<p>This is the workflow in the Echo test example:</p>

<ul>
<li>Client initiaties the connection:</li>
</ul>

<pre><code class="http">Cache-Control:no-cache
Connection:Upgrade
Cookie:__utma=9925811.560021929.1398795440.1398795440.1399893753.2; __utmb=9925811.2.10.1399893753; __utmc=9925811; __utmz=9925811.1399893753.2.2.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)
Host:echo.websocket.org
Origin:http://www.websocket.org
Pragma:no-cache
Sec-WebSocket-Extensions:permessage-deflate; client_max_window_bits, x-webkit-deflate-frame
Sec-WebSocket-Key:j6MZV0bC4TBsmQHmnlsEyw==
Sec-WebSocket-Version:13
Upgrade:websocket
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36
</code></pre>

<ul>
<li>Server response:</li>
</ul>

<pre><code class="http">Access-Control-Allow-Credentials:true
Access-Control-Allow-Headers:x-websocket-protocol
Access-Control-Allow-Headers:x-websocket-version
Access-Control-Allow-Headers:x-websocket-extensions
Access-Control-Allow-Headers:authorization
Access-Control-Allow-Headers:content-type
Access-Control-Allow-Origin:http://www.websocket.org
Connection:Upgrade
Date:Mon, 12 May 2014 11:25:46 GMT
Sec-WebSocket-Accept:Psgr6cQUXMgP1tz5StleqjOWtpE=
Server:Kaazing Gateway
Upgrade:WebSocket
</code></pre>

<p>After that we have a fully working websocket. The browser has a permanent connection to the webserver as we can see using netstat:</p>

<pre><code class="bash">% nslookup echo.websocket.org
Server:     192.168.1.1
Address:    192.168.1.1#53

Non-authoritative answer:
echo.websocket.org  canonical name = echo-kaazing.websocket.org.
echo-kaazing.websocket.org  canonical name = websocket.org.
Name:   websocket.org
Address: 174.129.224.73

% netstat -tn | grep 174.129.224.73
tcp4       0      0  192.168.1.7.50195      174.129.224.73.80      ESTABLISHED
</code></pre>

<p>If we want to use websockets in our javascript application we can use the example of <a href="http://www.websocket.org/aboutwebsocket.html">websocket</a>:</p>

<pre><code class="javascript">// Code from websocket.org
var myWebSocket = new WebSocket(&quot;ws://www.websockets.org&quot;); 
myWebSocket.onopen = function(evt) { alert(&quot;Connection open ...&quot;); };
myWebSocket.onmessage = function(evt) { alert( &quot;Received Message: &quot; + evt.data); }; 
myWebSocket.onclose = function(evt) { alert(&quot;Connection closed.&quot;); }; 
myWebSocket.send(&quot;Hello WebSockets!&quot;); myWebSocket.close();
</code></pre>

            </div>
              <div id="disqus_thread"></div>
    <script type="text/javascript">
         
        var disqus_shortname = 'javiersegura'; 

         
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
        </div>

        
        <div class="col-md-3">
            <div class="well well-sm"> 
                <h4>May 13, 2014<br>
                <small>278 words</small></h4>
                <hr>
                <strong>Categories</strong>
                <ul class="list-unstyled">
                
                    <li><a href="http://javiersegura.net/categories/web">web</a></li>
                
                </ul>
                <hr>
                <strong>Tags</strong><br>
                <a class="label label-default" href="http://javiersegura.net/tags/websockets">websockets</a> 
            </div>
                <div class="panel">
        <div class="panel-heading" style="padding: 2px 15px;">
            <h4>Javier Segura</h4>
        </div>
        <div class="panel-body">
        	<p>Developer. System Administrator. Geek</p>
            <a href="https://github.com/jsegura/" class="btn-default"><i class="fa fa-github"></i> @jsegura</a><br/>
            <a href="https://twitter.com/jsegura/" class="btn-default"><i class="fa fa-twitter"></i> @jsegura</a>
        </div>
    </div>
        </div>
    </div>
        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; Javier Segura 2014<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>

    <script src="http://javiersegura.net/js/jquery-2.1.1-min.js"></script>
    <script src="http://javiersegura.net/js/bootstrap.js"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50885811-1', 'javiersegura.net');
  ga('send', 'pageview');

</script>
</body>
</html>